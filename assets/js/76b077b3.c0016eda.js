"use strict";(self.webpackChunk_1_inch_docs=self.webpackChunk_1_inch_docs||[]).push([[6542],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return u}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),l=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),h=l(n),u=r,m=h["".concat(c,".").concat(u)]||h[u]||d[u]||o;return n?a.createElement(m,i(i({ref:t},p),{},{components:n})):a.createElement(m,i({ref:t},p))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},97238:function(e,t,n){n.d(t,{k:function(){return u}});var a,r=n(51721),o=n(67294),i="fileDownload__Qwh",s="fileDownloadIcon_PkAi",c="fileDownloadTitle_teui",l=["title","titleId"];function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},p.apply(this,arguments)}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var h=function(e){var t=e.title,n=e.titleId,r=d(e,l);return o.createElement("svg",p({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",style:{height:"20.8px",width:"20.8px"},"aria-labelledby":n},r),t?o.createElement("title",{id:n},t):null,a||(a=o.createElement("path",{d:"M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"})))},u=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.link,n=e.title;return o.createElement("a",{className:i,href:t,target:"_blank"},o.createElement(h,{className:s}),o.createElement("p",{className:c},n))},t}(o.Component)},5872:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return p},default:function(){return h}});var a=n(87462),r=n(63366),o=(n(67294),n(3905)),i=(n(97238),["components"]),s={sidebar_position:1},c="Quick start",l={unversionedId:"aggregation-protocol/guide/quick-start",id:"aggregation-protocol/guide/quick-start",isDocsHomePage:!1,title:"Quick start",description:"In this guide, we will provide an example token swap of 0.1 1INCH for DAI at the best possible rate on the market.",source:"@site/docs/aggregation-protocol/guide/quick-start.mdx",sourceDirName:"aggregation-protocol/guide",slug:"/aggregation-protocol/guide/quick-start",permalink:"/docs/aggregation-protocol/guide/quick-start",editUrl:"https://github.com/1inch/1inch-docs/edit/master/docs/aggregation-protocol/guide/quick-start.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/docs/aggregation-protocol/introduction"},next:{title:"Legal",permalink:"/docs/aggregation-protocol/api/legal"}},p=[{value:"Checking allowances",id:"checking-allowances-1",children:[{value:"Step 1: Set Up Your Environment",id:"step-1-set-up-your-environment",children:[]},{value:"Step 2: Define Your Swap Parameters",id:"step-2-define-your-swap-parameters",children:[]},{value:"Step 3: Define API URLs and Initialize Web3 Libraries",id:"step-3-define-api-urls-and-initialize-web3-libraries",children:[]},{value:"Step 4: Define Helper Functions",id:"step-4-define-helper-functions",children:[]},{value:"Step 5: Check Token Allowance",id:"step-5-check-token-allowance",children:[]}]},{value:"Creating the token allowance (approval) transaction",id:"creating-the-token-allowance-approval-transaction",children:[{value:"Step 1:",id:"step-1",children:[]},{value:"Step 2: Implement Helper Functions",id:"step-2-implement-helper-functions",children:[]},{value:"Step 3: Build the Body of the Transaction",id:"step-3-build-the-body-of-the-transaction",children:[]},{value:"Step 4: Confirm and Send the Transaction",id:"step-4-confirm-and-send-the-transaction",children:[]}]},{value:"Making the Swap",id:"making-the-swap",children:[{value:"Step 1: Set Up Environment and Define Swap Parameters",id:"step-1-set-up-environment-and-define-swap-parameters",children:[]},{value:"Step 2: Implement Helper Functions",id:"step-2-implement-helper-functions-1",children:[]},{value:"Step 3: Build the Body of the Transaction",id:"step-3-build-the-body-of-the-transaction-1",children:[]},{value:"Step 4: Confirm and Send the Transaction",id:"step-4-confirm-and-send-the-transaction-1",children:[]}]}],d={toc:p};function h(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"quick-start"},"Quick start"),(0,o.kt)("p",null,"In this guide, we will provide an example token swap of 0.1 1INCH for DAI at the best possible rate on the market."),(0,o.kt)("p",null,"This process includes:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("h5",{parentName:"li",id:"checking-allowances"},"Checking allowances")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("h5",{parentName:"li",id:"creating-the-allowanceapproval-transaction"},"Creating the allowance/approval transaction")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("h5",{parentName:"li",id:"making-a-swap"},"Making a swap"))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This example uses Binance Chain network; however, it can be replicated on any network supported by 1inch Aggregation Protocol. "))),(0,o.kt)("h2",{id:"checking-allowances-1"},"Checking allowances"),(0,o.kt)("h3",{id:"step-1-set-up-your-environment"},"Step 1: Set Up Your Environment"),(0,o.kt)("p",null,"First, import the necessary Node.js libraries and set up your environment variables."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const Web3 = require('web3'); // Import the Web3 library for interacting with Ethereum\nconst fetch = require('node-fetch'); // Import the fetch library for making HTTP requests\nconst yesno = require('yesno'); // Import the yesno library for prompting user input\n\nconst chainId = 56; // The chain ID for the Binance Smart Chain (BSC)\nconst web3RpcUrl = 'https://bsc-dataseed.binance.org'; // The URL for the BSC node you want to connect to\nconst walletAddress = '0x...xxx'; // Set your wallet address (replace '0x...xxx' with your actual wallet address)\nconst privateKey = '0x...xxx'; // Set the private key of your wallet (replace '0x...xxx' with your actual private key). NEVER SHARE THIS WITH ANYONE!\n")),(0,o.kt)("h3",{id:"step-2-define-your-swap-parameters"},"Step 2: Define Your Swap Parameters"),(0,o.kt)("p",null,"Next, define the parameters for the swap you want to perform."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const swapParams = {\n    fromTokenAddress: '0x111111111117dc0aa78b770fa6a738034120c302', // The address of the token you want to swap from (1INCH)\n    toTokenAddress: '0x1af3f329e8be154074d8769d1ffa4ee058b1dbc3', // The address of the token you want to swap to (DAI)\n    amount: '100000000000000000', // The amount of the fromToken you want to swap (in wei)\n    fromAddress: 'YOUR_WALLET_ADDRESS', // Your wallet address from which the swap will be initiated\n    slippage: 1, // The maximum acceptable slippage percentage for the swap (e.g., 1 for 1%)\n    disableEstimate: false, // Whether to disable estimation of swap details (set to true to disable)\n    allowPartialFill: false, // Whether to allow partial filling of the swap order (set to true to allow)\n};\n")),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"For complete swap paramater descriptions, ",(0,o.kt)("a",{parentName:"li",href:"../api/swap-params"},(0,o.kt)("strong",{parentName:"a"},"see this page."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"amount: '100000000000000000'"),": This value is used because 1INCH token has 18 decimals as part of the ERC-20 token standard. ",(0,o.kt)("a",{parentName:"li",href:"https://ethereum.org/en/developers/docs/standards/tokens/erc-20/"},(0,o.kt)("strong",{parentName:"a"},"Learn more")),".")))),(0,o.kt)("h3",{id:"step-3-define-api-urls-and-initialize-web3-libraries"},"Step 3: Define API URLs and Initialize Web3 Libraries"),(0,o.kt)("p",null,"Now, define the API URLs and initialize Web3. Web3 is a collection of libraries which allow you to interact with a local or remote Ethereum node, using HTTP, IPC, or WebSocket."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const broadcastApiUrl = 'https://tx-gateway.1inch.io/v1.1/' + chainId + '/broadcast';\nconst apiBaseUrl = 'https://api.1inch.io/v5.0/' + chainId;\nconst web3 = new Web3(web3RpcUrl);\n")),(0,o.kt)("h3",{id:"step-4-define-helper-functions"},"Step 4: Define Helper Functions"),(0,o.kt)("p",null,"Define a series of helper functions that will be used to interact with the 1inch API."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Construct full API request URL\nfunction apiRequestUrl(methodName, queryParams) {\n    return apiBaseUrl + methodName + '?' + (new URLSearchParams(queryParams)).toString();\n}\n\nfunction checkAllowance(tokenAddress, walletAddress) {\n    return fetch(apiRequestUrl('/approve/allowance', {tokenAddress, walletAddress}))\n        .then(res => res.json())\n        .then(res => res.allowance);\n}\n")),(0,o.kt)("h3",{id:"step-5-check-token-allowance"},"Step 5: Check Token Allowance"),(0,o.kt)("p",null,"Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"checkAllowance")," function to check the current allowance of the token."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const allowance = await checkAllowance(swapParams.fromTokenAddress, walletAddress);\nconsole.log('Allowance: ', allowance);\n")),(0,o.kt)("p",null,"At this point, you'll have set up your environment, defined your swap parameters, defined your API endpoints, and checked the allowance for the token you are selling."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you haven't previously approved or swapped this asset using 1inch Aggregation Protocol, then ",(0,o.kt)("inlineCode",{parentName:"p"},"> Allowance: 0")," will be displayed in the console.\nThis means that the 1inch router does not have access to swap this token within your wallet."))),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"creating-the-token-allowance-approval-transaction"},"Creating the token allowance (approval) transaction"),(0,o.kt)("p",null,"In order for the 1inch aggregation protocol to access tokens in your wallet, you must create an approval transaction. This specifies that the 1inch router is allowed to swap a specific amount of the token chosen."),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Approval transactions require payment of a blockchain gas fee! This amount is deducted in the form of native tokens from your wallet."))),(0,o.kt)("h3",{id:"step-1"},"Step 1:"),(0,o.kt)("p",null,"Similar to the Allowance Check, you'll first neet to set up your environment, define swap paramaters and API endpoints, and initialize Web3 libraries."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const Web3 = require('web3');\nconst fetch = require('node-fetch');\nconst yesno = require('yesno');\n\nconst chainId = 56;\nconst web3RpcUrl = 'https://bsc-dataseed.binance.org';\nconst walletAddress = '0x...xxx'; // Set your wallet address\nconst privateKey = '0x...xxx'; // Set private key of your wallet. Be careful! NEVER share this key with anyone!\n\nconst swapParams = {\n    fromTokenAddress: '0x111111111117dc0aa78b770fa6a738034120c302', // 1INCH\n    toTokenAddress: '0x1af3f329e8be154074d8769d1ffa4ee058b1dbc3', // DAI\n    amount: '100000000000000000', //18 decimals (in gwei)\n    fromAddress: walletAddress,\n    slippage: 1,\n    disableEstimate: false,\n    allowPartialFill: false,\n};\n\n// API endpoints\nconst broadcastApiUrl = 'https://tx-gateway.1inch.io/v1.1/' + chainId + '/broadcast';\nconst apiBaseUrl = 'https://api.1inch.io/v5.0/' + chainId;\nconst web3 = new Web3(web3RpcUrl);\n")),(0,o.kt)("h3",{id:"step-2-implement-helper-functions"},"Step 2: Implement Helper Functions"),(0,o.kt)("p",null,"Implement helper functions to interact with the 1inch API, including constructing the API request URL, broadcasting raw transactions, signing and sending transactions, and preparing approval transactions considering the gas limit."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Construct full API request URL\nfunction apiRequestUrl(methodName, queryParams) {\n    return apiBaseUrl + methodName + '?' + (new URLSearchParams(queryParams)).toString();\n}\n\n// Post raw transaction to the API and return transaction hash\nasync function broadCastRawTransaction(rawTransaction) {\n    return fetch(broadcastApiUrl, {\n        method: 'post',\n        body: JSON.stringify({ rawTransaction }),\n        headers: { 'Content-Type': 'application/json' }\n    })\n        .then(res => res.json())\n        .then(res => {\n            return res.transactionHash;\n        });\n}\n\n// Sign and post a transaction, return its hash\nasync function signAndSendTransaction(transaction) {\n    const { rawTransaction } = await web3.eth.accounts.signTransaction(transaction, privateKey);\n\n    return await broadCastRawTransaction(rawTransaction);\n}\n\n// Prepare approval transaction, considering gas limit\nasync function buildTxForApproveTradeWithRouter(tokenAddress, amount) {\n    const url = apiRequestUrl(\n        '/approve/transaction',\n        amount ? { tokenAddress, amount } : { tokenAddress }\n    );\n\n    const transaction = await fetch(url).then(res => res.json());\n\n    const gasLimit = await web3.eth.estimateGas({\n        ...transaction,\n        from: walletAddress\n    });\n\n    return {\n        ...transaction,\n        gas: gasLimit\n    };\n}\n")),(0,o.kt)("h3",{id:"step-3-build-the-body-of-the-transaction"},"Step 3: Build the Body of the Transaction"),(0,o.kt)("p",null,"Prepare the transaction data for approval using the ",(0,o.kt)("inlineCode",{parentName:"p"},"buildTxForApproveTradeWithRouter")," function and store it in ",(0,o.kt)("inlineCode",{parentName:"p"},"transactionForSign"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const transactionForSign = await buildTxForApproveTradeWithRouter(swapParams.fromTokenAddress);\nconsole.log('Transaction for approve: ', transactionForSign);\n")),(0,o.kt)("h3",{id:"step-4-confirm-and-send-the-transaction"},"Step 4: Confirm and Send the Transaction"),(0,o.kt)("p",null,"Prompt the user to confirm the transaction using the ",(0,o.kt)("inlineCode",{parentName:"p"},"yesno")," library. If confirmed, sign and send the transaction. Otherwise, exit without signing."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const ok = await yesno({\n    question: 'Do you want to send a transaction to approve trade with 1inch router?'\n});\n\nif (!ok) {\n    return false;\n}\n\nconst approveTxHash = await signAndSendTransaction(transactionForSign);\nconsole.log('Approve tx hash: ', approveTxHash);\n")),(0,o.kt)("p",null,"After running this code in the console, you should see something like this:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"> Approve tx hash: 0xb87c133e203fe66b487e27ab0afde71842dc34ab97aca60c147c7662505312a6")),(0,o.kt)("p",null,"With the transaction hash, you can monitor its execution using the blockchain explorer."),(0,o.kt)("p",null,"For the Binance Chain, you can use bscscan.com:\n",(0,o.kt)("a",{parentName:"p",href:"https://bscscan.com/tx/0xb87c133e203fe66b487e27ab0afde71842dc34ab97aca60c147c7662505312a6"},"https://bscscan.com/tx/0xb87c133e203fe66b487e27ab0afde71842dc34ab97aca60c147c7662505312a6")),(0,o.kt)("img",{"data-theme-mode":"light",src:"/img/aggregation-protocol/approve-tx-28632bffb938d72c00a57e17d00aea43-light.png"}),(0,o.kt)("img",{"data-theme-mode":"dark",src:"/img/aggregation-protocol/approve-tx-28632bffb938d72c00a57e17d00aea43-dark.png"}),(0,o.kt)("p",null,"That's it! At this point, you have checked for token allowances and sent a transaction granting the 1inch router access to your tokens. Next, we will make the swap!"),(0,o.kt)("br",null),(0,o.kt)("h2",{id:"making-the-swap"},"Making the Swap"),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Before proceeding, please confirm that your approval transaction has a status of ",(0,o.kt)("inlineCode",{parentName:"p"},"Success"),"!"))),(0,o.kt)("h3",{id:"step-1-set-up-environment-and-define-swap-parameters"},"Step 1: Set Up Environment and Define Swap Parameters"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Set up environment and import necessary libraries\nconst Web3 = require('web3');\nconst fetch = require('node-fetch');\nconst yesno = require('yesno');\n\n// Define the chain ID and Web3 RPC URL\nconst chainId = 56;\nconst web3RpcUrl = 'https://bsc-dataseed.binance.org';\n\n// Set your wallet address and private key\nconst walletAddress = '0x...xxx';\nconst privateKey = '0x...xxx';\n\n// Define the swap parameters\nconst swapParams = {\n    fromTokenAddress: '0x111111111117dc0aa78b770fa6a738034120c302', // 1INCH\n    toTokenAddress: '0x1af3f329e8be154074d8769d1ffa4ee058b1dbc3', // DAI\n    amount: '100000000000000000',\n    fromAddress: walletAddress,\n    slippage: 1,\n    disableEstimate: false,\n    allowPartialFill: false,\n};\n")),(0,o.kt)("h3",{id:"step-2-implement-helper-functions-1"},"Step 2: Implement Helper Functions"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Define the API endpoints for broadcasting and interacting with 1inch\nconst broadcastApiUrl = 'https://tx-gateway.1inch.io/v1.1/' + chainId + '/broadcast';\nconst apiBaseUrl = 'https://api.1inch.io/v5.0/' + chainId;\n\n// Create a new instance of Web3 using the provided RPC URL\nconst web3 = new Web3(web3RpcUrl);\n\n// Construct the full API request URL based on the method and query parameters\nfunction apiRequestUrl(methodName, queryParams) {\n    return apiBaseUrl + methodName + '?' + (new URLSearchParams(queryParams)).toString();\n}\n\n// Post a raw transaction to the 1inch API and return the transaction hash\nasync function broadCastRawTransaction(rawTransaction) {\n    return fetch(broadcastApiUrl, {\n        method: 'post',\n        body: JSON.stringify({ rawTransaction }),\n        headers: { 'Content-Type': 'application/json' }\n    })\n        .then(res => res.json())\n        .then(res => {\n            return res.transactionHash;\n        });\n}\n\n// Sign and send a transaction using the provided private key\nasync function signAndSendTransaction(transaction) {\n    const { rawTransaction } = await web3.eth.accounts.signTransaction(transaction, privateKey);\n\n    return await broadCastRawTransaction(rawTransaction);\n}\n")),(0,o.kt)("h3",{id:"step-3-build-the-body-of-the-transaction-1"},"Step 3: Build the Body of the Transaction"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Prepare the transaction data for the swap by making an API request\nasync function buildTxForSwap(swapParams) {\n    const url = apiRequestUrl('/swap', swapParams);\n\n    // Fetch the swap transaction details from the API\n    return fetch(url)\n        .then(res => res.json())\n        .then(res => res.tx);\n}\n\n// First, let's build the body of the transaction\nconst swapTransaction = await buildTxForSwap(swapParams);\nconsole.log('Transaction for swap: ', swapTransaction);\n")),(0,o.kt)("h3",{id:"step-4-confirm-and-send-the-transaction-1"},"Step 4: Confirm and Send the Transaction"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Prompt the user to confirm the transaction before signing and sending it\nconst ok = await yesno({\n    question: 'Do you want to send a transaction to exchange with 1inch router?'\n});\n\n// Confirm that all parameters are specified correctly before signing the transaction\nif (!ok) {\n    return false;\n}\n\n// Sign and send the swap transaction, and retrieve the transaction hash\nconst swapTxHash = await signAndSendTransaction(s\n")),(0,o.kt)("p",null,"After running this code in the console, you should see something like this:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"> Swap tx hash: 0xe591e17cc2b33e6a244fb2a98deb83b4659f94cf867ef7730b614d1feaa7cf9d")),(0,o.kt)("p",null,"Let's check the result of the transaction on the explorer:\n",(0,o.kt)("a",{parentName:"p",href:"https://bscscan.com/tx/0xe591e17cc2b33e6a244fb2a98deb83b4659f94cf867ef7730b614d1feaa7cf9d"},"https://bscscan.com/tx/0xe591e17cc2b33e6a244fb2a98deb83b4659f94cf867ef7730b614d1feaa7cf9d")),(0,o.kt)("img",{"data-theme-mode":"light",src:"/img/aggregation-protocol/swaptx-light.png"}),(0,o.kt)("img",{"data-theme-mode":"dark",src:"/img/aggregation-protocol/swaptx-dark.png"}))}h.isMDXComponent=!0}}]);